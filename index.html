// Reemplaza la función cargarMatrizAutomatica() por esto:

async function cargarMatrizDesdeGitHub() {
    const url = "https://raw.githubusercontent.com/TU-USUARIO/TU-REPOSITORIO/main/52MILMATRIX.xlsx";
    
    try {
        const response = await fetch(url);
        if (!response.ok) throw new Error("No se encontró el archivo en GitHub");
        
        const arrayBuffer = await response.arrayBuffer();
        const workbook = XLSX.read(arrayBuffer, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const json = XLSX.utils.sheet_to_json(sheet, { defval: "" });

        let cargados = 0;
        matrizUbicaciones.clear();

        json.forEach(row => {
            const suministro = normalizarSuministro(row.SUMINISTRO || row['SUMINISTRO'] || '');
            const lat = parseFloat(row.LATITUD || row.LAT || row.Latitud);
            const lng = parseFloat(row.LONGITUD || row.LON || row.Longitud);

            if (suministro && !isNaN(lat) && !isNaN(lng) && lat !== 0 && lng !== 0) {
                matrizUbicaciones.set(suministro, { lat, lng });
                cargados++;
            }
        });

        alert(`Matriz cargada automáticamente desde GitHub\n${cargados} suministros con coordenadas válidas.`);
    } catch (err) {
        console.error(err);
        alert("No se pudo cargar la matriz desde GitHub.\nVerifica que '52MILMATRIX.xlsx' esté en el repositorio y sea público.\nPuedes cargarla manualmente con el botón.");
        document.getElementById('excelFile').click();
    }
}

// Llama a la función al cargar la página
window.addEventListener('load', cargarMatrizDesdeGitHub);
